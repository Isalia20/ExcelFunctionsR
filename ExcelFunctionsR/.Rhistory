} else if (is.character(criteria10) == T){
c10 <- "=="
}
ret <- sum(sum_range[c(get(c1)(criteria_range1,criteria1))&
c(get(c2)(criteria_range2,criteria2))&
c(get(c3)(criteria_range3,criteria3))&
c(get(c4)(criteria_range4,criteria4))&
c(get(c5)(criteria_range5,criteria5))&
c(get(c6)(criteria_range6,criteria6))&
c(get(c7)(criteria_range7,criteria7))&
c(get(c8)(criteria_range8,criteria8))&
c(get(c9)(criteria_range9,criteria9))&
c(get(c10)(criteria_range10,criteria10))])
options(warn=0)
ret
}
SUMIFS(Names$Cost,"<2.6",Names$Sales)
SUMIFS(Names$Sales,Names$Cost,"<3.5")
Return <- MAXIFS(iris$Petal.Length,iris$Species,"virginica",iris$Petal.Width,"<3.4")
build()
devtools::build()
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.1.tar.gz", repos = NULL)
detach("package:ExcelFunctionsR", unload = TRUE)
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.1.tar.gz", repos = NULL)
library(ExcelFunctionsR)
Return <- MAXIFS(iris$Petal.Length,iris$Species,"virginica",iris$Petal.Width,"<3.4")
library(tinytest)
expect_equal(Return,6.9)
Return <- MAXIF(iris$Species,"virginica",iris$Sepal.Length)
expect_equal(Return,7.9)
iris[iris$Species == "virginica" & iris$Petal.Width < 3.4]
iris[iris$Species == "virginica" & iris$Petal.Width < 3.4,]
iris$Petal.Length[iris$Species == "virginica" & iris$Petal.Width < 3.4,]
iris$Petal.Length[iris$Species == "virginica" & iris$Petal.Width < 3.4]
max(iris$Petal.Length[iris$Species == "virginica" & iris$Petal.Width < 3.4])
Return <- MID("This is a string!",6,2)
Return <- MINIF(iris$Species,"virginica",iris$Sepal.Length)
Return <- MINIFS(iris$Petal.Length,iris$Species,"virginica",iris$Petal.Width,"<3.4")
expect_equal(Return,6.9)
expect_equal(Return,4.5)
Return <- MONTH(DATE(2020,12,1))
expect_equal(Return,12)
Return <- NOT(TRUE)
expect_equal(Return,FALSE)
Return <- NOW()
expect_equal(Return,Sys.time())
Sys.time()
lubridate::as_datetime(   format(Sys.time(),"%Y-%m-%d %H:%M"))
lubridate::as_datetime(format(Sys.time(),"%Y-%m-%d %H:%M"))
expect_equal(Return,format(Sys.time(),"%Y-%m-%d %H:%M"))
Return <- NOW()
expect_equal(Return,format(Sys.time(),"%Y-%m-%d %H:%M"))
expect_equal(NOW(),format(Sys.time(),"%Y-%m-%d %H:%M"))
Return <- OR(iris$Species == TRUE, iris$Sepal.Length = 4.5)
Return <- OR(iris$Species == TRUE, iris$Sepal.Length == 4.5)
sum(Return)
Return <- OR(iris$Species == "virginica", iris$Sepal.Length == 4.5)
sum(Return)
iris$Species == "virginica" |
iris$Sepal.Length == 4.5
expect_equal(Return,sum(iris$Species == "virginica" |
iris$Sepal.Length == 4.5))
Return <- OR(iris$Species == "virginica", iris$Sepal.Length == 4.5)
expect_equal(Return,sum(iris$Species == "virginica" |
iris$Sepal.Length == 4.5))
sum(iris$Species == "virginica" |
iris$Sepal.Length == 4.5)
Return
Return <- sum(OR(iris$Species == "virginica", iris$Sepal.Length == 4.5))
expect_equal(Return,sum(iris$Species == "virginica" |
iris$Sepal.Length == 4.5))
Return <- RAND()
set.seed(123)
Return <- RAND()
set.seed(123)
Return <- RAND()
set.seed(123)
Return <- RAND()
eexpect_equal(Return,0.287577520124614)
expect_equal(Return,0.287577520124614)
set.seed(123)
Return <- RAND()
expect_equal(Return,0.287577520124614)
set.seed(123)
Return <- RAND()
expect_equal(Return,0.287577520124614)
Return <- RANDBETWEEN(1,100,number = 1)
set.seed(123)
Return <- RANDBETWEEN(1,100,number = 1)
set.seed(123)
Return <- RANDBETWEEN(1,100,number = 1)
set.seed(123)
Return <- RANDBETWEEN(1,100,number = 1)
expect_equal(Return,29)
REPT("YesNo",number_times = 3, AsOne = T)
expect_equal(Return,rep("YesNo",times = 3))
Return <- REPT("YesNo",number_times = 3, AsOne = T)
expect_equal(Return,rep("YesNo",times = 3))
rep("YesNo",times = 3)
expect_equal(Return,c(rep("YesNo",times = 3),collapse = T))
c(rep("YesNo",times = 3),collapse = T)
Return <- REPT("YesNo",number_times = 3, AsOne = F)
expect_equal(Return,c(rep("YesNo",times = 3)))
Return <- RIGHT("YesYes!",4)
expect_equal(Return,"Yes!")
Return <- STDEV(1,2,3,4)
expect_equal(Return,1.29099444873581)
SUBSTITUTE("SUB THIS","SUB","THIS IS")
Return <- SUBSTITUTE("SUB THIS","SUB","THIS IS")
expect_equal(Return,"THIS IS THIS")
Return <- SUMIF(iris$Species,"virginica",iris$Petal.Length)
expect_equal(Return,277.6)
Return <- SUMIFS(iris$Sepal.Length,iris$Species,"virginica",
iris$Sepal.Length,">1.4")
expect_equal(Return,329.4)
TODAY()
return <- TODAY()
expect_equal(return,Sys.Date())
Return <- UPPER("is this lower?")
expect_equal(Return,"IS THIS LOWER?")
load("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR/data/Sales.rda")
load("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR/data/Streets.rda")
View(Sales)
View(Streets)
Return <- VLOOKUP(Sales,"Country",Streets,"Country","Street")
View(Return)
Return <- VLOOKUP(Sales,"Country",Streets,"Country","Street")
VLOOKUP <-
function(lookup_from_table,lookup_column_value = "Name of the column to lookup",lookup_where_table,
lookup_where_table_column = "Name of the column to compare",
return_which_column = "Name of the column to return"){
ColumnNamesOfLookUpTable <- colnames(lookup_from_table)
lookup_from_table$OrderOfColsfpmwepovmasovkimoimovmev <- c(1:nrow(lookup_from_table))
temptable <- lookup_from_table
Merged <- merge(lookup_from_table[,c("OrderOfColsfpmwepovmasovkimoimovmev",lookup_column_value)],
lookup_where_table[,c(lookup_where_table_column,return_which_column)],
by.x = lookup_column_value,
by.y = lookup_where_table_column,
all.x = T )
Non_Merged <- lookup_from_table[,!colnames(lookup_from_table) == lookup_column_value]
srt <- order(Merged$OrderOfColsfpmwepovmasovkimoimovmev)
Merged <- Merged[srt,]
Merged$OrderOfColsfpmwepovmasovkimoimovmev <- NULL
Final <- cbind(Merged,Non_Merged)
Final[,c(ColumnNamesOfLookUpTable,return_which_column)]
}
Return <- VLOOKUP(Sales,"Country",Streets,"Country","Street")
View(Return)
expect_equal(ncol(Return),5)
WEEKDAY <-
function(date, return = "number"){
wkday <- wday(date, week_start = 1)
ifelse(return == "number", wkday,
ifelse(wkday == 1,"Monday",ifelse(wkday == 2, "Tuesday",ifelse(wkday==3,"Wednesday",ifelse(wkday==4,"Thursday",
ifelse(wkday==5,"Friday",
ifelse(wkday==6,"Saturday",
ifelse(wkday==7,"Sunday"))))))))
}
Return <- WEEKDAY(DATE(2020,1,1),"d")
Return <- WEEKDAY(DATE(2020,1,1),"number")
Return <- WEEKDAY(DATE(2020,1,1),"character")
expect_equal(Return,"Wednesday")
Return <- YEAR(DATE(2020,1,1))
expect_equal(Return,2020)
check()
devtools::check()
devtools::check()
devtools::test()
devtools::check()
devtools::check()
devtools::document()
devtools::check()
remove.packages("ExcelFunctionsR", lib="~/R/R-4.0.0/library")
build()
devtools::build()
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.1.tar.gz", repos = NULL)
detach(ExcelFunctionsR)
detach("ExcelFunctionsR")
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.1.tar.gz", repos = NULL)
devtools::build()
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.1.tar.gz", repos = NULL)
library(ExcelFunctionsR)
detach(ExcelFunctionsR)
detach("ExcelFunctionsR")
detach("package:ExcelFunctionsR", unload = TRUE)
remove.packages("ExcelFunctionsR", lib="~/R/R-4.0.0/library")
build()
devtools::check()
devtools::build()
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.2.tar.gz", repos = NULL)
install.packages("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR_0.1.2.tar.gz", repos = NULL)
library(ExcelFunctionsR)
rnorm(1,mean = 1,sd = 1.5)
rnorm(1,mean = 1,sd = 1.5)
i <- 1
for (i in 1:100){
rnorm(1,mean = 1,sd = 1.5)
i <- i + 1
}
for (i in 1:100){
ret <- rnorm(1,mean = 1,sd = 1.5)
i <- i + 1
ret
}
for (i in 1:100){
ret <- rnorm(1,mean = 1,sd = 1.5)
i <- i + 1
print(ret)
}
rnorm(1,2.5,1.5)
RANDBETWEEN(1,2)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
rnorm(1,2.5,1.5)
ExcelFunctionsR::RANDBETWEEN(1,2)
ExcelFunctionsR::RANDBETWEEN(1,10)
ExcelFunctionsR::RANDBETWEEN(1,10)
ExcelFunctionsR::RANDBETWEEN(1,10)
ExcelFunctionsR::RANDBETWEEN(1,25)
ExcelFunctionsR::RANDBETWEEN(1,25)
ExcelFunctionsR::RANDBETWEEN(1,25)
ExcelFunctionsR::RANDBETWEEN(1,10)
ExcelFunctionsR::RANDBETWEEN(1,10)
ExcelFunctionsR::RANDBETWEEN(1,10)
stringr::str_split("String",pattern = "")
data <- readxl::read_excel("C:/Users/TBCBank/Desktop/Names.xlsx")
data
str_split(data$Names, pattern = "")
stringr::str_split(data$Names, pattern = "")
class(stringr::str_split(data$Names, pattern = ""))
stringr::str_split(data$Names, pattern = "")
stringr::str_split(data$Names, pattern = "")[[1]][1]
stringr::str_split(data$Names, pattern = "")[[-1]]
stringr::str_split(data$Names, pattern = "")[[c(2,3)]]
stringr::str_split(data$Names, pattern = "")[[2,3]]
stringr::str_split(data$Names, pattern = "")[[1]][1]
nrow(stringr::str_split(data$Names, pattern = ""))
length(stringr::str_split(data$Names, pattern = ""))
ls()
list.files()
for (i in 1:length(list.files()))
1:length(list.files())
1:length(list.files())
for (i in 1:length(list.files())){
names <- paste("File",i)
assign(names,list.files()[i])
}
library(KeyboardSimulator)
library(base)
i <- 1
while (T) {
if (i == 1){
mouse.move(-264,77)
mouse.click()
i <- 2
}
keybd.press('ctrl')
Sys.sleep(30)
}
while (T) {
if (i == 1){
mouse.move(-264,77)
mouse.click()
i <- 2
}
keybd.press('ctrl')
Sys.sleep(30)
}
library(KeyboardSimulator)
library(base)
i <- 1
while (T) {
if (i == 1){
mouse.move(-264,77)
mouse.click()
i <- 2
}
keybd.press('ctrl')
Sys.sleep(30)
}
class(10)
DATE <-
function(year,month,day){
dateval <- paste(year,month,day)
as.Date(dateval, '%Y %m %d')
}
DATE(2020,1,1)
as.class(DATE(2020,1,1))
class(DATE(2020,1,1))
DATEDIF <-
function(start_date,end_date,difference = "d"){
ifelse(difference == "d", extract_numeric(end_date - start_date),
ifelse(difference == "m" & (as.numeric(format(end_date, '%Y')) - as.numeric(format(start_date, '%Y'))) == 0 ,
as.numeric(format(end_date, '%m')) - as.numeric(format(start_date,'%m')),
ifelse(difference == "m" & (as.numeric(format(end_date, '%Y')) - as.numeric(format(start_date, '%Y'))) > 0,
(as.numeric(format(end_date,'%Y')) - as.numeric(format(start_date,'%Y')) ) * 12 +
as.numeric(format(end_date,'%m')) - as.numeric(format(start_date, '%m')),
as.numeric(format(end_date, '%Y')) - as.numeric(format(start_date, '%Y')))))
}
DATEDIF(DATE(2020,1,1),DATE(2020,2,1),"d")
library(tidyr)
DATEDIF(DATE(2020,1,1),DATE(2020,2,1),"d")
DATEDIF(DATE(2020,1,1),DATE(2020,2,1),"d") * 2
DATEDIF(DATE(2020,1,1),DATE(2020,2,1),"m") * 2
DATEDIF(DATE(2020,1,1),DATE(2020,2,1),"Y") * 2
DAYS <-
function(start_date,end_date){
extract_numeric(end_date - start_date)
}
DAYS(DATE(2020,2,1),DATE(2020,2,15))
EOMONTH <-
function(date,months = 0){
if (months == 0) {month(date) <- month(date) + 1
day(date) <- 1
day(date) <- day(date)-1
date
} else {
month(date) <- month(date) + months + 1
day(date) <- 1
day(date) <- day(date) - 1
date
}
}
EOMONTH(DATE(2008,6,2))
library(lubridate)
EOMONTH(DATE(2008,6,2))
class(EOMONTH(DATE(2008,6,2)))
FIND <-
function(find_text,within_text) {
for (i in 1:length(within_text)){
if (i == 1){
tmp <- gregexpr(pattern = find_text, text = within_text)[[i]][1]
} else {
tmp <- rbind(tmp,gregexpr(pattern = find_text,text = within_text)[[i]][1])
}
}
return(tmp)
}
FIND("CRAN","I LOVE CRAN")
IFNA <-
function(value,value_if_na){
ifelse(is.na(value), value_if_na,value)
}
class(IFNA(NA,"It is NA"))
NOW <-
function(){
format(Sys.time(),"%Y-%m-%d %H:%M")
}
class(NOW())
REPT <-
function(text,number_times,AsOne = T){
if (AsOne == F){rep(text,number_times)
} else{
if (is.numeric(text) == T) { as.numeric(paste(rep(text,number_times),collapse = ""))
} else {
paste(rep(text,number_times),collapse = "")
}
}
}
REPT("Oi",2,AsOne = TRUE)
SUBSTITUTE <-
function(text,old_text,new_text){
str_replace_all(text,pattern = old_text, replacement = new_text)
}
SUBSTITUTE("CRAN","RAN","out")
#'
#' @param text Where should it substitute the characters
#' @param  old_text Which text should it substitute
#' @param new_text What should it substitute with.
#' @import base
#' @import stringr
#' @export
#' @examples
#' SUBSTITUTE("CRAN","RAN","out")
#' @return In this example we take text "CRAN", we take the old text "RAN" and replace it with "out" which in return gives us "Cout"
library(stringr)
library(stringr)
SUBSTITUTE <-
function(text,old_text,new_text){
str_replace_all(text,pattern = old_text, replacement = new_text)
}
SUBSTITUTE("CRAN","RAN","out")
Sales
load("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR/data/Sales.rda")
load("C:/Users/TBCBank/Desktop/RProject/ExcelFunctionsR/data/Streets.rda")
View(Sales)
View(Streets)
WEEKDAY <-
function(date, return = "number"){
wkday <- wday(date, week_start = 1)
ifelse(return == "number", wkday,
ifelse(wkday == 1,"Monday",ifelse(wkday == 2, "Tuesday",ifelse(wkday==3,"Wednesday",ifelse(wkday==4,"Thursday",
ifelse(wkday==5,"Friday",
ifelse(wkday==6,"Saturday",
ifelse(wkday==7,"Sunday"))))))))
}
WEEKDAY(DATE(2020,2,1),return = "number")
WEEKDAY(DATE(2020,2,1),return = "character")
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
library(devtools)
document()
getwd()
document()
check()
document()
check()
document()
remove.packages("ExcelFunctionsR", lib="~/R/R-4.0.0/library")
check()
devtools::check()
devtools::check()
devtools::check()
document()
devtools::document()
devtools::check()
devtools::check()
devtools::build()
MATCH <-
function(lookup_value,lookup_array){
which(lookup_array == lookup_value)[1]
}
iris
View(MATCH)
Return <- MATCH("virginica",iris$Species)
library(testthat)
library(tinytest)
expect_equal(Return,101L)
devtools::document()
devtools::check()
devtools::build()
devtools::document()
devtools::check()
devtools::build()
Return <- MATCH("virginica",iris$Species)
expect_equal(Return,101L)
install.packages("ExcelFunctionsr")
install.packages("ExcelFunctionsR")
